<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8"/>
	<title></title>
</head>
<body>
<div id="status">

</div>
</body>
<script type="text/javascript">

	getTest("http://localhost/server.php");



function postTest(){
	var xhr = createXHR();
	// xhr.onreadystatechange = function(){
	// 	if(xhr.readyState == 4){
	// 		//只有这几个状态说明才成功了
	// 		if((xhr.status >= 200 && xhr.status < 300)|| xhr.status == 304){
	// 			alert(xhr.responseText);
	// 			// alert(xhr.responseXML);
	// 		}else{
	// 			alert("请求失败，错误信息："+xhr.statusText);
	// 		}
	// 	}
	// }
	xhr.onload=function(event){
			if((xhr.status >= 200 && xhr.status < 300)|| xhr.status == 304){
				alert(xhr.responseText);
				// alert(xhr.responseXML);
			}else{
				alert("请求失败，错误信息："+xhr.statusText);
			}
	}
	xhr.onprogress= function(event){
		var divStatus = document.getElementById("status");
		if(event.lengthComputable){
			divStatus.innerHTML = "Received：" + event.loaded + "of " + event.total + "字节";
		}
	}
	var data = "name=123&age=5";
	var str = "111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111";
	if(window.FormData){
		data = new FormData();
		data.append("name",str);
		data.append("age",12);
	}
	xhr.open("post","http://localhost/weixin/test.php",true);
	// xhr.timeout = 2000;
	// xhr.ontimeout = function(){
	// 	alert("超时了，我还是放弃吧");
	// }
	xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	xhr.send(data);
}



function getTest(url){
	var xhr = createXHR();
	xhr.onreadystatechange = function(){
		if(xhr.readyState == 3){
			console.log(xhr.responseText);
			//只有这几个状态说明才成功了
//			if((xhr.status >= 200 && xhr.status < 300)|| xhr.status == 304){
//				console.log(xhr.responseText);
//			}else{
//				alert("请求失败，错误信息："+xhr.statusText);
//			}
		}
	}
	xhr.open("get",url,true);
	xhr.send(null);
}



					function createXHR(){
						var xhr = null;
						if(window.XMLHttpRequest){
							xhr = new XMLHttpRequest();
						}else if(window.ActiveXObject){
							var xhrVersions = ["MSXML2.XMLHttp","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp.6.0"],
									i,len;
							for(i = 0, len = xhrVersions.length; i < len; i++){
								try{
									xhr = new ActiveXObject(xhrVersions[i]);
									if(xhr){
					break;
				}
			}catch(e){
			}
		}
	}else{
		throw new Error("No XHR object available");
	}
	return xhr;
}

var XHRFactory = (function(){
	var method;
	//can't create a XHR object
	var error = function(){
		throw new Error("can not create a XHR!!");
	}
	//标准的方式
	var standard = function(){
		return new XMLHttpRequest();
	}
	//IE newer
	var activex6 = function(){
		return new ActiveXObject("MSXML2.XMLHttp.6.0");
	}
	//IE
	var activex3 = function(){
		return new ActiveXObject("MSXML2.XMLHttp.3.0");
	}
	//IE older
	var activex = function(){
		return new ActiveXObject("MSXML2.XMLHttp");
	}
	if(!method){
				if(window.XMLHttpRequest){
					method = standard;
				}else if(window.ActiveXObject){
					try{
						activex6();
						method = activex6;
					}catch(e){
						try{
							activex3();
							method = activex3;
						}catch(e){
							activex();
							method = activex;
						}
					}
				}else{
					method = error;
				}
	}
	return {
		createXHR:method
	}
}());
</script>
</html>